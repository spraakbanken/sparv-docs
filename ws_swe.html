<p>Sparv har ett API som ligger på adressen:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv</code></p>
</blockquote>
<p>Den här dokumentationen är för API-version 2.</p>
<h2 id="anrop-för-att-annotera-text">Anrop för att annotera text</h2>
<p>Frågor till nättjänsten kan göras med ett enkelt GET-anrop:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv/?text=En+exempelmening+till+nättjänsten</code></p>
</blockquote>
<p>Svaret kommer i form av ett XML-objekt. För detta anropet blir svaret:</p>
<pre><code>&lt;result&gt;
&lt;build hash=&quot;edb2a4717701a65b721d97834a56b129dc3bf6aa&quot;/&gt;
&lt;corpus link=&quot;https://ws.spraakbanken.gu.se/ws/sparv/download?hash=edb2a4717701a65b721d97834a56b129dc3bf6aa&quot;&gt;
&lt;text lix=&quot;54.00&quot; ovix=&quot;inf&quot; nk=&quot;inf&quot;&gt;
&lt;paragraph&gt;
&lt;sentence id=&quot;8f7-84d&quot;&gt;
&lt;w pos=&quot;DT&quot; msd=&quot;DT.UTR.SIN.IND&quot; lemma=&quot;|en|&quot; lex=&quot;|en..al.1|&quot; sense=&quot;|den..1:-1.000|en..2:-1.000|&quot; complemgram=&quot;|&quot; compwf=&quot;|&quot; sentiment=&quot;0.6799&quot; ref=&quot;1&quot; dephead=&quot;2&quot; deprel=&quot;DT&quot;&gt;En&lt;/w&gt;
&lt;w pos=&quot;NN&quot; msd=&quot;NN.UTR.SIN.IND.NOM&quot; lemma=&quot;|exempelmening|&quot; lex=&quot;|&quot; sense=&quot;|&quot; complemgram=&quot;|exempel..nn.1+mening..nn.1:7.044e-09|&quot; compwf=&quot;|exempel+mening|&quot; ref=&quot;2&quot; deprel=&quot;ROOT&quot;&gt;exempelmening&lt;/w&gt;
&lt;w pos=&quot;PP&quot; msd=&quot;PP&quot; lemma=&quot;|till|&quot; lex=&quot;|till..pp.1|&quot; sense=&quot;|till..1:-1.000|&quot; complemgram=&quot;|&quot; compwf=&quot;|&quot; sentiment=&quot;0.5086&quot; ref=&quot;3&quot; dephead=&quot;2&quot; deprel=&quot;ET&quot;&gt;till&lt;/w&gt;
&lt;w pos=&quot;NN&quot; msd=&quot;NN.UTR.SIN.DEF.NOM&quot; lemma=&quot;|nättjänst|nättjänsten|&quot; lex=&quot;|&quot; sense=&quot;|&quot; complemgram=&quot;|nät..nn.1+tjänst..nn.2:6.813e-11|nät..nn.1+tjänst..nn.1:6.813e-11|nätt..av.1+tjänst..nn.1:1.039e-12|nätt..av.1+tjänst..nn.2:1.039e-12|nät..nn.1+tjäna..vb.1+sten..nn.1:1.047e-26|nät..nn.1+tjäna..vb.1+sten..nn.2:1.047e-26|nätt..av.1+tjäna..vb.1+sten..nn.2:2.120e-27|nätt..av.1+tjäna..vb.1+sten..nn.1:2.120e-27|&quot; compwf=&quot;|nät+tjänsten|nätt+tjänsten|nät+tjän+sten|nätt+tjän+sten|&quot; ref=&quot;4&quot; dephead=&quot;3&quot; deprel=&quot;PA&quot;&gt;nättjänsten&lt;/w&gt;
&lt;/sentence&gt;
&lt;/paragraph&gt;
&lt;/text&gt;
&lt;/corpus&gt;
&lt;/result&gt;</code></pre>
<p>För större texter stöds också POST-anrop som skickas till samma address. Ett exempel med curl:</p>
<blockquote>
<p><code>curl -X POST --data-binary text=&quot;En exempelmening till nättjänsten&quot; https://ws.spraakbanken.gu.se/ws/sparv/</code></p>
</blockquote>
<p>Svaret blir samma som för ovanstående GET-anropet.</p>
<p>Det är också möjligt att ladda upp XML- eller textfiler med curl:</p>
<blockquote>
<p><code>curl -X POST -F files[]=@/path/to/file/myfile.txt https://ws.spraakbanken.gu.se/ws/sparv/upload?</code></p>
</blockquote>
<p>Svaret är en nedladdningslänk till en zip-fil som innehåller annotationen.</p>
<h2 id="inställningar">Inställningar</h2>
<p>Nättjänsten har stöd för bland annat att byta ord-, mening- och styckessegmenterare och vilka attribut som ska genereras. Dessa ges som ett JSON-objekt till <code>settings</code>-variabeln. Detta objekt måste uppfylla JSON-schemat som fås av detta anrop:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv/schema</code></p>
</blockquote>
<p>Eftersom schemat innehåller <code>default</code>-värden för alla inställningar är detta argument valfritt, och alla inställningar behövs inte anges.</p>
<p>Ett anrop där bara dependensinformationen genereras ser ut så här:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv/?text=Det+trodde+jag+aldrig.&amp;settings={&quot;positional_attributes&quot;:{&quot;dependency_attributes&quot;:[&quot;ref&quot;,&quot;dephead&quot;,&quot;deprel&quot;],&quot;lexical_attributes&quot;:[],&quot;compound_attributes&quot;:[]}}</code></p>
</blockquote>
<p>POST-anropet med curl görs såhär:</p>
<blockquote>
<p><code>curl -X POST -g --data-binary text=&quot;Det trodde jag aldrig.&quot; 'https://ws.spraakbanken.gu.se/ws/sparv/?settings={&quot;positional_attributes&quot;:{&quot;dependency_attributes&quot;:[&quot;ref&quot;,&quot;dephead&quot;,&quot;deprel&quot;],&quot;lexical_attributes&quot;:[],&quot;compound_attributes&quot;:[]}}'</code></p>
</blockquote>
<p>På <a href="http://spraakbanken.gu.se/sparv">frontenden</a> så finns en knapp <code>Visa Formulärets JSON</code> under <code>Visa avancerade inställningar</code> som visar formulärets JSON-objekt som skickas med i <code>settings</code>-variabeln.</p>
<p>Makefilen som genereras för ett visst inställningsobjekt kan också fås. Ett anrop ser ut så här:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv/makefile?settings={&quot;positional_attributes&quot;:{&quot;dependency_attributes&quot;:[&quot;ref&quot;,&quot;dephead&quot;,&quot;deprel&quot;],&quot;lexical_attributes&quot;:[],&quot;compound_attributes&quot;:[]}}</code></p>
</blockquote>
<h2 id="återuppta-byggen">Återuppta byggen</h2>
<p>Längst upp i svarets XML finns ett hash-nummer i <code>build</code>-taggens <code>hash</code>-attribut. Detta kan användas för att återuppta byggen. För att visa första exemplet ovan används detta anrop:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv/join?hash=edb2a4717701a65b721d97834a56b129dc3bf6aa</code></p>
</blockquote>
<p>Svaret innehåller förutom det annoterade resultatet också orginaltexten och vilka inställningar som användes (grundinställningarna). Hela svaret ser ut så här:</p>
<pre><code>&lt;result&gt;
    &lt;settings&gt;{
      &quot;root&quot;: {
        &quot;attributes&quot;: [],
        &quot;tag&quot;: &quot;text&quot;
      },
      &quot;text_attributes&quot;: {
        &quot;readability_metrics&quot;: [
          &quot;lix&quot;,
          &quot;ovix&quot;,
          &quot;nk&quot;
        ]
      },
      &quot;word_segmenter&quot;: &quot;default_tokenizer&quot;,
      &quot;positional_attributes&quot;: {
        &quot;lexical_attributes&quot;: [
          &quot;pos&quot;,
          &quot;msd&quot;,
          &quot;lemma&quot;,
          &quot;lex&quot;,
          &quot;sense&quot;
        ],
        &quot;compound_attributes&quot;: [
          &quot;complemgram&quot;,
          &quot;compwf&quot;
        ],
        &quot;dependency_attributes&quot;: [
          &quot;ref&quot;,
          &quot;dephead&quot;,
          &quot;deprel&quot;
        ],
        &quot;sentiment&quot;: [
          &quot;sentiment&quot;
        ]
      },
      &quot;sentence_segmentation&quot;: {
        &quot;sentence_chunk&quot;: &quot;paragraph&quot;,
        &quot;sentence_segmenter&quot;: &quot;default_tokenizer&quot;
      },
      &quot;paragraph_segmentation&quot;: {
        &quot;paragraph_segmenter&quot;: &quot;blanklines&quot;
      },
      &quot;lang&quot;: &quot;sv&quot;,
      &quot;textmode&quot;: &quot;plain&quot;,
      &quot;named_entity_recognition&quot;: [],
      &quot;corpus&quot;: &quot;untitled&quot;
}&lt;/settings&gt;
&lt;original&gt;&amp;lt;text&amp;gt;En exempelmening till nättjänsten&amp;lt;/text&amp;gt;&lt;/original&gt;
&lt;build hash=&#39;edb2a4717701a65b721d97834a56b129dc3bf6aa&#39;/&gt;
&lt;corpus link=&#39;https://ws.spraakbanken.gu.se/ws/sparv/download?hash=edb2a4717701a65b721d97834a56b129dc3bf6aa&#39;&gt;
    &lt;text lix=&quot;54.00&quot; ovix=&quot;inf&quot; nk=&quot;inf&quot;&gt;
        &lt;paragraph&gt;
            &lt;sentence id=&quot;8f7-84d&quot;&gt;
                &lt;w pos=&quot;DT&quot; msd=&quot;DT.UTR.SIN.IND&quot; lemma=&quot;|en|&quot; lex=&quot;|en..al.1|&quot; sense=&quot;|den..1:-1.000|en..2:-1.000|&quot; complemgram=&quot;|&quot; compwf=&quot;|&quot; sentiment=&quot;0.6799&quot; ref=&quot;1&quot; dephead=&quot;2&quot; deprel=&quot;DT&quot;&gt;En&lt;/w&gt;
                &lt;w pos=&quot;NN&quot; msd=&quot;NN.UTR.SIN.IND.NOM&quot; lemma=&quot;|exempelmening|&quot; lex=&quot;|&quot; sense=&quot;|&quot; complemgram=&quot;|exempel..nn.1+mening..nn.1:7.044e-09|&quot; compwf=&quot;|exempel+mening|&quot; ref=&quot;2&quot; deprel=&quot;ROOT&quot;&gt;exempelmening&lt;/w&gt;
                &lt;w pos=&quot;PP&quot; msd=&quot;PP&quot; lemma=&quot;|till|&quot; lex=&quot;|till..pp.1|&quot; sense=&quot;|till..1:-1.000|&quot; complemgram=&quot;|&quot; compwf=&quot;|&quot; sentiment=&quot;0.5086&quot; ref=&quot;3&quot; dephead=&quot;2&quot; deprel=&quot;ET&quot;&gt;till&lt;/w&gt;
                &lt;w pos=&quot;NN&quot; msd=&quot;NN.UTR.SIN.DEF.NOM&quot; lemma=&quot;|nättjänst|nättjänsten|&quot; lex=&quot;|&quot; sense=&quot;|&quot; complemgram=&quot;|nät..nn.1+tjänst..nn.2:6.813e-11|nät..nn.1+tjänst..nn.1:6.813e-11|nätt..av.1+tjänst..nn.1:1.039e-12|nätt..av.1+tjänst..nn.2:1.039e-12|nät..nn.1+tjäna..vb.1+sten..nn.1:1.047e-26|nät..nn.1+tjäna..vb.1+sten..nn.2:1.047e-26|nätt..av.1+tjäna..vb.1+sten..nn.2:2.120e-27|nätt..av.1+tjäna..vb.1+sten..nn.1:2.120e-27|&quot; compwf=&quot;|nät+tjänsten|nätt+tjänsten|nät+tjän+sten|nätt+tjän+sten|&quot; ref=&quot;4&quot; dephead=&quot;3&quot; deprel=&quot;PA&quot;&gt;nättjänsten&lt;/w&gt;
            &lt;/sentence&gt;
        &lt;/paragraph&gt;
    &lt;/text&gt;
&lt;/corpus&gt;
&lt;/result&gt;</code></pre>
<h2 id="analys-av-andra-språk-än-svenska">Analys av andra språk än svenska</h2>
<p>Som standard sker analysen på svenska, men det finns även stöd för andra språk. Språkval görs genom <code>settings</code>-variabeln <code>lang</code>. För närvarande finns det stöd för följande språk:</p>
<ul>
<li>bulgariska (bg)</li>
<li>engelska (en)</li>
<li>estniska (et)</li>
<li>finska (fi)</li>
<li>franska (fr)</li>
<li>italienska (it)</li>
<li>latin (la)</li>
<li>nederländska (nl)</li>
<li>polska (pl)</li>
<li>portugisiska (pt)</li>
<li>ryska (ru)</li>
<li>slovakiska (sk)</li>
<li>spanska (es)</li>
<li>tyska (de)</li>
</ul>
<p>Ett exempel på analys av tyska kan se ut så här:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv/?text=Nun+folgt+ein+deutscher+Beispielsatz.&amp;settings={&quot;lang&quot;:&quot;de&quot;}</code></p>
</blockquote>
<p>Beroende på vilket språk man väljer, finns det stöd för olika annotationer och verktyg. Använd <a href="http://spraakbanken.gu.se/sparv">frontenden</a> för att enklast se vilka valmöjligheter som finns för ett visst språk.</p>
<h2 id="inkrementell-framstegsinformation">Inkrementell framstegsinformation</h2>
<p>Med flaggan till anropen ovan <code>incremental=true</code> fås information om hur byggprocessen förlöper. Ett exempelanrop ser ut så här:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv/?text=Nu+med+inkrementell+information&amp;incremental=true</code></p>
</blockquote>
<p>Resultat-XML:en innehåller då dessa extra taggar:</p>
<pre><code>&lt;increment command=&quot;&quot; step=&quot;0&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.segment&quot; step=&quot;1&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.segment&quot; step=&quot;2&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.number --position&quot; step=&quot;3&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.segment&quot; step=&quot;4&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.annotate --span_as_value&quot; step=&quot;5&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.annotate --text_spans&quot; step=&quot;6&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.parent --children&quot; step=&quot;7&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.parent --parents&quot; step=&quot;8&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.parent --parents&quot; step=&quot;9&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.parent --parents&quot; step=&quot;10&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.number --position&quot; step=&quot;11&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.hunpos&quot; step=&quot;12&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.number --relative&quot; step=&quot;13&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.annotate --select&quot; step=&quot;14&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.saldo&quot; step=&quot;15&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.readability --lix&quot; step=&quot;16&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.readability --ovix&quot; step=&quot;17&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.readability --nominal_ratio&quot; step=&quot;18&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.compound&quot; step=&quot;19&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.wsd&quot; step=&quot;20&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.malt&quot; step=&quot;21&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.sentiment&quot; step=&quot;22&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.annotate --select&quot; step=&quot;23&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.annotate --select&quot; step=&quot;24&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.annotate --chain&quot; step=&quot;25&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;sb.cwb --export&quot; step=&quot;26&quot; steps=&quot;27&quot;/&gt;
&lt;increment command=&quot;&quot; step=&quot;27&quot; steps=&quot;27&quot;/&gt;</code></pre>
<p>Denna variabel kan kombineras med <code>settings</code>, samt med <code>/join</code>, och med POST-anrop.</p>
<h2 id="övriga-anrop">Övriga anrop</h2>
<p>Du kan få en kort översikt över alla anrop här:</p>
<blockquote>
<p><code>https://ws.spraakbanken.gu.se/ws/sparv/api</code></p>
</blockquote>
<!--
## Övriga anrop
Visar om nättjänstens python-bakända svarar på ping:

> `https://ws.spraakbanken.gu.se/ws/sparv/ping`

Statusarna för alla byggen:

> `https://ws.spraakbanken.gu.se/ws/sparv/status`

Ta bort byggen som inte hämtats på över 24 timmar:

> `https://ws.spraakbanken.gu.se/ws/sparv/cleanup`

Ta bort felaktiga byggen:

> `https://ws.spraakbanken.gu.se/ws/sparv/cleanup/errors`

Visa nättjänstens api i ett swagger-ui JSON-schema:

> `https://ws.spraakbanken.gu.se/ws/sparv/api`
-->
